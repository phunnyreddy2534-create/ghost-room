<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ghost Room</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>

<header class="top">
  <div class="logo">üëª Ghost Room</div>
</header>

<main class="home">
  <h1>Speak freely.</h1>
  <p class="hero-sub">
    Private rooms that appear quietly ‚Äî and vanish without a trace.
  </p>

  <div class="room-actions">
    <button id="createBtn" class="primary-btn">Create Room</button>
    <button id="joinOpenBtn" class="secondary-btn">Join Room</button>
  </div>

  <div id="homeMessage"></div>

  <section class="why">
    <h2>Why Ghost Room?</h2>
    <ul>
      <li>üï∂Ô∏è No identity, ever</li>
      <li>‚è≥ Rooms expire by design</li>
      <li>üîí No logs, no recovery</li>
      <li>üí¨ Conversations without pressure</li>
    </ul>
  </section>

  <p class="about-link">
    <a href="about.html">About ¬∑ Vision ¬∑ Trust ‚Üí</a>
  </p>
</main>

<!-- CREATE ROOM MODAL -->
<div id="createModal" class="modal hidden">
  <div class="premium-card">

    <h2>üëª Create Ghost Room</h2>
    <p class="subtitle">Private ¬∑ Temporary ¬∑ Anonymous</p>

    <div class="option">
      <strong>Room lifetime</strong>

      <!-- Continuous selector (UI only) -->
      <input
        type="range"
        id="lifetimeRange"
        min="1"
        max="1440"
        value="30"
        class="range"
      />

      <!-- ‚úÖ MISSING #1: Explicit range -->
      <small class="range-helper">
        From <strong>1 minute</strong> to <strong>24 hours</strong>
      </small>

      <div class="range-label" id="lifetimeLabel">
        This room will quietly disappear in <strong>30 minutes</strong>.
      </div>

      <!-- ‚úÖ MISSING #2: Inactivity expectation -->
      <small class="hint">
        No countdown. No warnings. Rooms may disappear sooner if left inactive.
      </small>
    </div>

    <div class="option locked">
      Custom rules ¬∑ Creator-only (coming soon)
    </div>

    <label class="agree">
      <input type="checkbox" id="agreeRules">
      I understand this room is temporary and cannot be recovered
    </label>

    <div class="card-actions">
      <button id="cancelCreate" class="ghost-btn">Cancel</button>

      <!-- ‚úÖ MISSING #3: Post-create expectation -->
      <button id="confirmCreate" class="primary-btn">Create & Enter</button>
    </div>

  </div>
</div>

<!-- JOIN ROOM MODAL -->
<div id="joinModal" class="modal hidden">
  <div class="premium-card">

    <h2>Enter quietly</h2>
    <p class="subtitle">You won‚Äôt leave a trace.</p>

    <button class="ghost-btn wide" disabled>
      Scan QR (coming soon)
    </button>

    <input id="joinCode" placeholder="Room code" />

    <div class="card-actions">
      <button id="cancelJoin" class="ghost-btn">Cancel</button>
      <button id="confirmJoin" class="primary-btn">Join Room</button>
    </div>

  </div>
</div>

<script>
/* ================= SUPABASE (UNCHANGED) ================= */
const supabaseClient = supabase.createClient(
  "https://ehvusinvfwsaxguuebfc.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVodnVzaW52ZndzYXhndXVlYmZjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjczNTcyMzYsImV4cCI6MjA4MjkzMzIzNn0.6W8OrbTz6RhN3P3R0KIN80Ec9GlkoMF4F0-Q4xRyy48"
);

function showHomeMessage(msg){
  document.getElementById("homeMessage").textContent = msg;
}

/* ================= CREATE ROOM (LOGIC UNCHANGED) ================= */
async function createRoom(){
  const id = Math.random().toString(36).substring(2,8);
  showHomeMessage("Creating secure room‚Ä¶");
  try{
    await supabaseClient.from("rooms").insert([{ room_code:id, expired:false }]);
  }catch(e){}
  window.location.href = `room.html?room=${id}`;
}

/* ================= UI INTERACTIONS ================= */
const lifetimeRange = document.getElementById("lifetimeRange");
const lifetimeLabel = document.getElementById("lifetimeLabel");

lifetimeRange.oninput = () => {
  const minutes = parseInt(lifetimeRange.value, 10);
  let text =
    minutes < 60
      ? `${minutes} minutes`
      : minutes < 1440
        ? `${Math.round(minutes / 60)} hours`
        : `24 hours`;

  lifetimeLabel.innerHTML =
    `This room will quietly disappear in <strong>${text}</strong>.`;
};

confirmCreate.onclick = () => {
  if(!agreeRules.checked){
    alert("Please agree to continue");
    return;
  }
  createModal.classList.add("hidden");
  createRoom();
};

confirmJoin.onclick = () => {
  const code = joinCode.value.trim();
  if(!code){
    alert("Enter room code");
    return;
  }
  window.location.href = `room.html?room=${code}`;
};

createBtn.onclick = ()=>createModal.classList.remove("hidden");
cancelCreate.onclick = ()=>createModal.classList.add("hidden");

joinOpenBtn.onclick = ()=>joinModal.classList.remove("hidden");
cancelJoin.onclick = ()=>joinModal.classList.add("hidden");
</script>

<style>
body{
  font-family:Inter,system-ui;
  background:#050507;
  color:#fff;
}

.hero-sub{
  opacity:.7;
  margin-bottom:28px;
}

.modal{
  position:fixed;
  inset:0;
  backdrop-filter:blur(14px);
  background:rgba(0,0,0,.65);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:1000;
}

.hidden{display:none}

.premium-card{
  width:90%;
  max-width:420px;
  background:linear-gradient(180deg,rgba(30,30,50,.92),rgba(18,18,30,.92));
  border-radius:26px;
  padding:24px;
  box-shadow:0 20px 60px rgba(0,0,0,.6);
  animation:emerge .35s ease;
}

@keyframes emerge{
  from{opacity:0;transform:translateY(24px) scale(.96)}
  to{opacity:1;transform:none}
}

.subtitle{
  opacity:.55;
  margin-bottom:18px;
}

.option{
  margin:18px 0;
}

.option.locked{
  opacity:.35;
}

.range{
  width:100%;
  margin-top:14px;
}

.range-helper{
  display:block;
  margin-top:6px;
  font-size:12px;
  opacity:.6;
}

.range-label{
  margin-top:10px;
  font-size:14px;
  opacity:.9;
}

.hint{
  font-size:12px;
  opacity:.5;
  margin-top:6px;
  display:block;
}

input{
  width:100%;
  padding:12px 14px;
  border-radius:16px;
  border:none;
  margin-top:14px;
}

.card-actions{
  display:flex;
  justify-content:space-between;
  margin-top:22px;
}

.primary-btn{
  background:linear-gradient(135deg,#6d5dfc,#9b8cff);
  border:none;
  padding:12px 20px;
  border-radius:16px;
  color:white;
  font-weight:600;
}

.secondary-btn{
  background:#1a1a22;
  padding:12px 20px;
  border-radius:16px;
  color:#ccc;
}

.ghost-btn{
  background:#0f0f16;
  border:1px solid #2a2a3a;
  color:#aaa;
  padding:12px 18px;
  border-radius:16px;
}

.ghost-btn.wide{
  width:100%;
}

.agree{
  display:flex;
  gap:8px;
  margin-top:14px;
  font-size:14px;
}
</style>

</body>
</html>
