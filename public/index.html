<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>IRA — Silent Anonymous Rooms</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#141633" />

  <link rel="stylesheet" href="style.css" />

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json" />
  <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <style>
    #appSplash{
      position:fixed;
      inset:0;
      background:radial-gradient(circle at top,#161844,#0A0B14 70%);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:9999;
      animation:fadeOut .8s ease forwards;
      animation-delay:2.4s;
    }
    @keyframes fadeOut{to{opacity:0;visibility:hidden}}

    .hero-title{font-size:36px;line-height:1.15}
  </style>
</head>

<body>

<!-- SPLASH -->
<div id="appSplash">
  <svg viewBox="0 0 100 100">
    <circle cx="50" cy="50" r="42" fill="none" stroke="#8E97FF" stroke-width="4"/>
    <path d="M20 52 C30 46 40 46 50 52 C60 58 70 58 80 52"
      fill="none" stroke="#6F7CFF" stroke-width="3" stroke-linecap="round"/>
  </svg>
</div>

<header class="top">
  <div class="logo">
    <svg class="ira-logo" viewBox="0 0 100 100">
      <circle cx="50" cy="50" r="42" fill="none" stroke="#6F7CFF" stroke-width="4"/>
      <path class="ira-wave"
        d="M20 52 C30 46 40 46 50 52 C60 58 70 58 80 52"
        fill="none" stroke="#8E97FF" stroke-width="3" stroke-linecap="round"/>
    </svg>
    <span class="logo-text">IRA</span>
  </div>
</header>

<main class="home">
  <h1 class="hero-title">Speak freely.</h1>

  <p class="hero-sub">
    Private rooms that appear quietly — and vanish without a trace.
  </p>

  <div class="room-actions">
    <button class="primary-btn" id="createBtn">Create Room</button>
    <button class="secondary-btn" id="joinBtn">Join Room</button>
  </div>

  <div id="statusMessage"
    style="margin-top:18px;font-size:13px;color:rgba(255,255,255,.5)">
  </div>
</main>

<!-- CREATE ROOM MODAL -->
<div id="createRoomModal" class="modal hidden">
  <div class="glass-card">

    <h2>Create a quiet room</h2>
    <p class="subtitle">This room will disappear automatically.</p>

    <label class="field">
      <span>Room name (optional)</span>
      <input id="roomName" placeholder="A quiet space…" />
    </label>

    <label class="field">
      <span>Description (optional)</span>
      <textarea id="roomDesc" rows="3"
        placeholder="What is this room for?"></textarea>
    </label>

    <div class="field">
      <span>Room duration</span>
      <select id="roomDuration">
        <option value="30">30 minutes</option>
        <option value="60">1 hour</option>
        <option value="180">3 hours</option>
        <option value="1440">24 hours</option>
      </select>
    </div>

    <label class="agree">
      <input type="checkbox" id="agreeTerms" />
      I understand this room will vanish and cannot be recovered
    </label>

    <div class="card-actions">
      <button class="ghost-btn" id="cancelCreate">Cancel</button>
      <button class="primary-btn" id="confirmCreate">Create & Enter</button>
    </div>

  </div>
</div>

<script>
/* ===== HELPERS ===== */
function makeRoomId(){
  return Math.random().toString(36).slice(2,9);
}
function goToRoom(id){
  location.href = `room.html?room=${encodeURIComponent(id)}`;
}

/* ===== UI LOGIC ===== */
document.addEventListener("DOMContentLoaded", ()=>{

  const createBtn = document.getElementById("createBtn");
  const joinBtn = document.getElementById("joinBtn");
  const modal = document.getElementById("createRoomModal");
  const cancelCreate = document.getElementById("cancelCreate");
  const confirmCreate = document.getElementById("confirmCreate");

  // OPEN MODAL
  createBtn.onclick = () => {
    modal.classList.remove("hidden");
  };

  // CLOSE MODAL
  cancelCreate.onclick = () => {
    modal.classList.add("hidden");
  };

  // CONFIRM CREATE
  confirmCreate.onclick = () => {
    if(!document.getElementById("agreeTerms").checked){
      alert("Please confirm before creating the room.");
      return;
    }
    goToRoom(makeRoomId());
  };

  // JOIN ROOM
  joinBtn.onclick = () => {
    let code = prompt("Enter room code or link:");
    if(!code) return;
    try{
      const u = new URL(code, location.href);
      code = u.searchParams.get("room") || code;
    }catch(e){}
    if(code.trim()) goToRoom(code.trim());
  };
});
</script>

</body>
</html>
